<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Online Test — HTML / CSS / Script</title>

  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent1:#7c3aed;--accent2:#06b6d4;--glass: rgba(255,255,255,0.04)}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; background:linear-gradient(180deg,#071025 0%, #07192a 60%);color:#e6eef6}

    header{display:flex;align-items:center;justify-content:space-between;padding:18px 28px;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 6px 20px rgba(12,18,35,0.6)}
    nav a{color:var(--muted);text-decoration:none;padding:8px 12px;border-radius:8px}
    nav a[href="#asosiy"]{color:#fff;background:linear-gradient(90deg,rgba(124,58,237,0.14),rgba(6,182,212,0.07));}

    main{display:flex;gap:24px;padding:22px;max-width:1100px;margin:18px auto;width:calc(100% - 40px)}

    .sidebar{width:260px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    .sidebar h3{margin:0 0 8px 0;color:#cfe9ff}
    .topic{display:flex;gap:10px;align-items:center;padding:10px;border-radius:10px;margin:8px 0;cursor:pointer}
    .topic:hover{background:var(--glass)}
    .topic.active{background:linear-gradient(90deg, rgba(124,58,237,0.12), rgba(6,182,212,0.06));}
    .topic .dot{width:12px;height:12px;border-radius:50%;background:linear-gradient(180deg,var(--accent1),var(--accent2));}

    .content{flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:20px;border-radius:14px;min-height:420px}
    .card{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px;margin-bottom:16px}
    .qtext{font-weight:600;margin-bottom:10px}
    .options{display:flex;flex-direction:column;gap:8px}
    .opt{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;transition:0.2s}
    .opt input{appearance:none;width:18px;height:18px;border-radius:6px;border:1px solid rgba(255,255,255,0.12);display:inline-block;transition:0.2s}
    .opt:hover{background:rgba(255,255,255,0.05)}
    .opt.selected{background:linear-gradient(90deg,rgba(124,58,237,0.25),rgba(6,182,212,0.25));box-shadow:0 0 8px rgba(6,182,212,0.3)}

    .controls{display:flex;justify-content:space-between;align-items:center;margin-top:10px;gap:12px}
    button{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;color:white;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
    button[disabled]{opacity:0.5;cursor:not-allowed}

    .result{padding:18px;border-radius:12px;margin-top:10px;background:linear-gradient(90deg, rgba(124,58,237,0.08), rgba(6,182,212,0.04));color:#fff}

    footer{max-width:1100px;margin:10px auto;text-align:center;color:var(--muted);font-size:13px}

    @media (max-width:900px){main{flex-direction:column;padding:12px} .sidebar{width:100%}}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">OT</div>
      <div>
        <div style="font-weight:700">Online Test</div>
        <div style="font-size:12px;color:var(--muted)">Html · Css · Script</div>
      </div>
    </div>
    <nav>
      <a href="index.html">Asosiy</a>
    </nav>
  </header>

  <main>
    <aside class="sidebar">
      <h3>Mavzular</h3>
      <div id="topics"></div>
      <div style="margin-top:18px;font-size:13px;color:var(--muted)">Test yakunlangach natijalar saqlanadi va JSON fayl sifatida yuklab olinadi.</div>
    </aside>

    <section class="content">
      <div id="test-area" class="card">
        <h2 id="topic-title">Iltimos mavzu tanlang</h2>
        <div id="questions"></div>

        <div class="controls">
          <div style="color:var(--muted);font-size:13px">Javoblar faqat test tugagach ko'rsatiladi.</div>
          <div>
            <button id="prevBtn" style="margin-right:8px">Oldingi</button>
            <button id="nextBtn">Keyingi</button>
            <button id="submitBtn">Testni tugatish</button>
          </div>
        </div>

        <div id="result" style="display:none" class="result"></div>
      </div>
    </section>
  </main>

  <footer>© Online Test — Tayyorlandi</footer>

  <script>
    const bank = [
      {id:'html',title:'HTML',qs:[{id:1,q:'HTML da sarlavha tegiga mos kod qaysi?',opts:['<head>','<h1>','<title>','<body>'],a:1},{id:2,q:'Form yaratish uchun qaysi teg ishlatiladi?',opts:['<form>','<input>','<fieldset>','<label>'],a:0}]},
      {id:'css',title:'CSS',qs:[{id:1,q:'CSS da rang belgilash uchun qaysi property ishlatiladi?',opts:['color','font','margin','display'],a:0},{id:2,q:'Elementni inline qilish uchun qaysi display qiymati ishlatiladi?',opts:['block','inline','flex','grid'],a:1}]},
      {id:'script',title:'Script (JavaScript)',qs:[{id:1,q:'console.log nima qiladi?',opts:['Matn chiqaradi','Logga yozadi','Skachat qiladi','xatolik beradi'],a:1},{id:2,q:'var x = 5; x += 3; natija nima?',opts:['5','8','3','NaN'],a:1}]}
    ];

    const topicsEl=document.getElementById('topics');
    const topicTitle=document.getElementById('topic-title');
    const questionsEl=document.getElementById('questions');
    const resultEl=document.getElementById('result');
    const prevBtn=document.getElementById('prevBtn');
    const nextBtn=document.getElementById('nextBtn');
    const submitBtn=document.getElementById('submitBtn');

    let state={topicIndex:null,qIndex:0,answers:{}};

    function renderTopics(){
      topicsEl.innerHTML='';
      bank.forEach((t,i)=>{
        const div=document.createElement('div');
        div.className='topic'+(i===state.topicIndex?' active':'');
        div.innerHTML=`<div class="dot"></div><div><strong>${t.title}</strong><div style="font-size:12px;color:var(--muted)">${t.qs.length} ta savol</div></div>`;
        div.onclick=()=>{ state.topicIndex=i; state.qIndex=0; state.answers[t.id]=state.answers[t.id]||{}; render(); };
        topicsEl.appendChild(div);
      });
    }

    function render(){
      renderTopics();
      if(state.topicIndex===null){ topicTitle.textContent='Iltimos mavzu tanlang'; questionsEl.innerHTML=''; return; }
      const topic=bank[state.topicIndex];
      topicTitle.textContent=topic.title;
      const q=topic.qs[state.qIndex];

      questionsEl.innerHTML = `
        <div class="card">
          <div class="qtext">${state.qIndex+1}. ${q.q}</div>
          <div class="options" id="opts"></div>
        </div>
      `;
      const optsEl=document.getElementById('opts');

      q.opts.forEach((o,oi)=>{
        const div=document.createElement('label');
        div.className='opt';
        const input=document.createElement('input');
        input.type='radio';
        input.name=`q_${topic.id}_${q.id}`;
        input.value=oi;
        input.checked=(state.answers[topic.id] && state.answers[topic.id][q.id]===oi);
        if(input.checked) div.classList.add('selected');
        input.onchange=()=>{ state.answers[topic.id]=state.answers[topic.id]||{}; state.answers[topic.id][q.id]=oi; render(); };
        div.appendChild(input);
        const span=document.createElement('div'); span.textContent=o;
        div.appendChild(span);
        optsEl.appendChild(div);
      });

      prevBtn.disabled = state.qIndex===0;
      nextBtn.disabled = state.qIndex===topic.qs.length-1;
      resultEl.style.display='none';
    }

    prevBtn.onclick=()=>{ if(state.qIndex>0){ state.qIndex--; render(); } };
    nextBtn.onclick=()=>{ const topic=bank[state.topicIndex]; if(state.qIndex < topic.qs.length-1){ state.qIndex++; render(); } };

    submitBtn.onclick=()=>{
      if(state.topicIndex===null){ alert('Iltimos avvalo mavzu tanlang.'); return; }
      const topic=bank[state.topicIndex];
      const userAnswers=state.answers[topic.id]||{};
      let correct=0;
      topic.qs.forEach(q=>{ if(String(userAnswers[q.id])===String(q.a)) correct++; });
      const total=topic.qs.length;
      resultEl.style.display='block';
      resultEl.innerHTML=`<strong>${topic.title} natija:</strong> ${correct} / ${total} <div style="margin-top:8px;color:var(--muted)">Javoblar test yakunlangach ko'rsatildi.</div>`;

      const payload={timestamp:new Date().toISOString(),topic:topic.id,title:topic.title,total,correct,answers:userAnswers};
      try{ localStorage.setItem('online_test_last', JSON.stringify(payload)); }catch(e){}
      const blob=new Blob([JSON.stringify(payload,null,2)],{type:'application/json'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url;
      a.download=`test_${topic.id}_${(new Date()).toISOString().replace(/[:.]/g,'-')}.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      showCorrectAnswers(topic);
    }

    function showCorrectAnswers(topic){
      questionsEl.innerHTML='';
      topic.qs.forEach((q,idx)=>{
        const user=(state.answers[topic.id] && state.answers[topic.id][q.id]);
        const card=document.createElement('div'); card.className='card';
        card.innerHTML = `<div class="qtext">${idx+1}. ${q.q}</div>`;
        const opts=document.createElement('div'); opts.className='options';
        q.opts.forEach((o,oi)=>{
          const row=document.createElement('div'); row.className='opt';
          const mark=document.createElement('div');
          mark.style.width='10px'; mark.style.height='10px'; mark.style.borderRadius='50%'; mark.style.marginRight='8px';
          if(Number(q.a)===oi){ mark.style.background='linear-gradient(180deg,var(--accent1),var(--accent2))'; }
          else if(String(user)===String(oi)){ mark.style.background='rgba(255,80,80,0.22)'; }
          else{ mark.style.background='rgba(255,255,255,0.02)'; }
          const label=document.createElement('div'); label.textContent=o;
          row.prepend(mark);
          row.appendChild(label);
          if(String(user)===String(oi)) row.classList.add('selected');
          opts.appendChild(row);
        });
        card.appendChild(opts);
        questionsEl.appendChild(card);
      });
    }

    renderTopics();
    render();
  </script>
</body>
</html>
